import{g as M}from"./ak.f9236663.js";import{r as O,u as R,l as N,b as C,g as T,e as F,T as g,f as l,_ as h,h as c,o as U,c as v,a as o,i as _,w as D,j as E,v as u,t as f,k as S,p as y,m as L}from"./index.cb58c82d.js";const W=async e=>await O("https://api.lc.familyeducation.org.cn/v1/user/auth/phone",e),b=async e=>await O("https://api.lc.familyeducation.org.cn/v1/user/auth/send",e);function V(){const e=R(),s=async(n,i)=>await W({phone:n,code:i}),a=async()=>await T(),r=async n=>await F({url:n}),d=n=>{const i=/^[1][3-9][\d]{9}/;return n?i.test(n)||g("\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E"):g("\u8BF7\u8F93\u5165\u624B\u673A\u53F7"),i.test(n)},m=N();return{onSubmit:async n=>{if(console.log("submit",n),!d(n.phone))return;const i=await s(n.phone,n.code);m.getLoginInfo(i.token,i.uid).then(async t=>{const P=await a();P.wx_id&&C().setWxId(P.wx_id),C().userInfo.wx_id?e.push({path:"/basicInformation"}):r("https://lc.familyeducation.org.cn/#/basicInformation").then(I=>{window.location.href=I})})}}}function j(e){const s=l(60),a=l(!1),r=async()=>{const m={phone:e.value};console.log(m),await b(m)};return{sendTime:s,isSend:a,handleSendCode:async()=>{await r(),a.value=!0;const m=setInterval(()=>{s.value--,s.value<=0&&(a.value=!1,s.value=0,clearTimeout(m))},1e3)}}}const x={setup(){R();const e=l(""),s=l(""),{onSubmit:a}=V();return{getImgUrl:M,phoneRef:e,codeRef:s,onSubmit:a,...j(e)}}},A=e=>(y("data-v-4ab401aa"),e=e(),L(),e),q={class:"flex-column root"},w=["src"],G={class:"field-wrap"},H={class:"flex"},K=A(()=>o("span",null,"+86",-1)),k=["src"],X={class:"field-wrap"},B={style:{"margin-top":"40px"}},J=A(()=>o("p",{class:"note"},[S(" \u767B\u5F55\u5373\u4EE3\u8868\u60A8\u540C\u610F "),o("span",{class:"red-char"},"\u300A\u7528\u6237\u4F7F\u7528\u534F\u8BAE\u300B"),S("\u548C "),o("span",{class:"red-char"},"\u300A\u9690\u79C1\u534F\u8BAE\u300B")],-1)),z={class:"circle-box"},Y=["src"],Z=["src"],$=["src"];function Q(e,s,a,r,d,m){const p=c("van-field"),n=c("van-button"),i=c("van-form");return U(),v("div",q,[o("img",{class:"img_happy",src:r.getImgUrl("login_img_happy.png"),alt:""},null,8,w),_(i,{class:"form-wrap",onSubmit:r.onSubmit},{default:D(()=>[o("div",G,[o("div",H,[K,o("img",{class:"arr-icon",src:r.getImgUrl("login_filed_arr.png"),alt:""},null,8,k)]),_(p,{class:"phoneRef-field",modelValue:r.phoneRef,"onUpdate:modelValue":s[0]||(s[0]=t=>r.phoneRef=t),name:"phone",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),o("div",X,[_(p,{class:"phoneRef-field",modelValue:r.codeRef,"onUpdate:modelValue":s[1]||(s[1]=t=>r.codeRef=t),name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),E(o("span",{class:"send-code",onClick:s[2]||(s[2]=(...t)=>e.handleSendCode&&e.handleSendCode(...t))},"\u83B7\u53D6\u9A8C\u8BC1\u7801",512),[[u,!e.isSend]]),E(o("span",{class:"send-code grey"},"\u5DF2\u53D1\u9001\uFF08"+f(e.sendTime)+"s\uFF09",513),[[u,e.isSend]])]),o("div",B,[_(n,{round:"",block:"",class:"btn-submit",type:"primary","native-type":"submit"},{default:D(()=>[S(" \u4E0B\u4E00\u6B65 ")]),_:1})])]),_:1},8,["onSubmit"]),J,o("div",z,[o("img",{class:"cic-img",src:r.getImgUrl("login_img_circle.png"),alt:""},null,8,Y),o("img",{class:"char-img",src:r.getImgUrl("login_bottom_char.png"),alt:""},null,8,Z),o("img",{class:"c-bottom",src:r.getImgUrl("login_img_circle.png"),alt:""},null,8,$)])])}const ne=h(x,[["render",Q],["__scopeId","data-v-4ab401aa"]]);export{ne as default};
