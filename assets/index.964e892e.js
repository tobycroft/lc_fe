import{g as M}from"./ak.42431a64.js";import{r as u,u as O,l as N,b as C,g as F,e as T,T as E,f as l,_ as U,h as S,o as h,c as v,a as o,i as _,w as g,j as D,v as R,t as f,k as c,p as y,m as L}from"./index.9a47bc96.js";const W=async e=>await u("https://api.lc.familyeducation.org.cn/v1/user/auth/phone",e),V=async e=>await u("https://api.lc.familyeducation.org.cn/v1/user/auth/send",e);function b(){const e=O(),s=async(n,i)=>await W({phone:n,code:i}),a=async()=>await F(),r=async n=>await T({url:n}),P=n=>{const i=/^[1][3-9][\d]{9}/;return n?i.test(n)||E("\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E"):E("\u8BF7\u8F93\u5165\u624B\u673A\u53F7"),i.test(n)},m=N();return{onSubmit:async n=>{if(console.log("submit",n),!P(n.phone))return;const i=await s(n.phone,n.code);m.getLoginInfo(i.token,i.uid).then(async t=>{const p=await a();p.wx_id&&C().setWxId(p.wx_id),C().userInfo.wx_id?e.push({path:"/basicInformation"}):r("https://lc.familyeducation.org.cn/#/basicInformation").then(I=>{window.location.href=I})})}}}function x(e){const s=l(60),a=l(!1),r=async()=>{const m={phone:e.value};console.log(m),await V(m)};return{sendTime:s,isSend:a,handleSendCode:async()=>{await r(),a.value=!0;const m=setInterval(()=>{s.value--,s.value<=0&&(a.value=!1,s.value=0,clearTimeout(m))},1e3)}}}const j={setup(){O();const e=l(""),s=l(""),{onSubmit:a}=b();return{getImgUrl:M,phoneRef:e,codeRef:s,onSubmit:a,...x(e)}}},A=e=>(y("data-v-4ab401aa"),e=e(),L(),e),q={class:"flex-column root"},w=["src"],G={class:"field-wrap"},K={class:"flex"},H=A(()=>o("span",null,"+86",-1)),B=["src"],X={class:"field-wrap"},k={style:{"margin-top":"40px"}},J=A(()=>o("p",{class:"note"},[c(" \u767B\u5F55\u5373\u4EE3\u8868\u60A8\u540C\u610F "),o("span",{class:"red-char"},"\u300A\u7528\u6237\u4F7F\u7528\u534F\u8BAE\u300B"),c("\u548C "),o("span",{class:"red-char"},"\u300A\u9690\u79C1\u534F\u8BAE\u300B")],-1)),z={class:"circle-box"},Y=["src"],$=["src"],Q=["src"];function Z(e,s,a,r,P,m){const d=S("van-field"),n=S("van-button"),i=S("van-form");return h(),v("div",q,[o("img",{class:"img_happy",src:r.getImgUrl("login_img_happy.png"),alt:""},null,8,w),_(i,{class:"form-wrap",onSubmit:r.onSubmit},{default:g(()=>[o("div",G,[o("div",K,[H,o("img",{class:"arr-icon",src:r.getImgUrl("login_filed_arr.png"),alt:""},null,8,B)]),_(d,{class:"phoneRef-field",modelValue:r.phoneRef,"onUpdate:modelValue":s[0]||(s[0]=t=>r.phoneRef=t),name:"phone",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),o("div",X,[_(d,{class:"phoneRef-field",modelValue:r.codeRef,"onUpdate:modelValue":s[1]||(s[1]=t=>r.codeRef=t),name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),D(o("span",{class:"send-code",onClick:s[2]||(s[2]=(...t)=>e.handleSendCode&&e.handleSendCode(...t))},"\u83B7\u53D6\u9A8C\u8BC1\u7801",512),[[R,!e.isSend]]),D(o("span",{class:"send-code grey"},"\u5DF2\u53D1\u9001\uFF08"+f(e.sendTime)+"s\uFF09",513),[[R,e.isSend]])]),o("div",k,[_(n,{round:"",block:"",class:"btn-submit",type:"primary","native-type":"submit"},{default:g(()=>[c(" \u4E0B\u4E00\u6B65 ")]),_:1})])]),_:1},8,["onSubmit"]),J,o("div",z,[o("img",{class:"cic-img",src:r.getImgUrl("login_img_circle.png"),alt:""},null,8,Y),o("img",{class:"char-img",src:r.getImgUrl("login_bottom_char.png"),alt:""},null,8,$),o("img",{class:"c-bottom",src:r.getImgUrl("login_img_circle.png"),alt:""},null,8,Q)])])}const ne=U(j,[["render",Z],["__scopeId","data-v-4ab401aa"]]);export{ne as default};
