import{g as N}from"./ak.696322b3.js";import{r as O,u as R,l as M,b as S,g as T,d as F,T as D,f as l,_ as v,h as c,o as U,c as h,a as o,i as _,w as g,j as E,v as u,t as f,k as C,p as L,m as y}from"./index.4e5c0170.js";const W=async e=>await O("https://api.lc.familyeducation.org.cn/v1/user/auth/phone",e),b=async e=>await O("https://api.lc.familyeducation.org.cn/v1/user/auth/send",e);function V(){const e=R(),s=async(n,i)=>await W({phone:n,code:i}),a=async()=>await T(),r=async n=>await F({url:n}),d=n=>{const i=/^[1][3-9][\d]{9}/;return n?i.test(n)||D("\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E"):D("\u8BF7\u8F93\u5165\u624B\u673A\u53F7"),i.test(n)},t=M();return{onSubmit:async n=>{if(console.log("submit",n),!d(n.phone))return;const i=await s(n.phone,n.code);t.getLoginInfo(i.token,i.uid).then(async m=>{const P=await a();P.wx_id&&S().setWxId(P.wx_id),S().userInfo.wx_id?(console.log(e),e.push({path:"/basicInformation"})):r("https://lc.familyeducation.org.cn/#/basicInformation").then(I=>{window.location.href=I})})}}}function j(e){const s=l(60),a=l(!1),r=async()=>{const t={phone:e.value};console.log(t),await b(t)};return{sendTime:s,isSend:a,handleSendCode:async()=>{await r(),a.value=!0;const t=setInterval(()=>{s.value--,s.value<=0&&(a.value=!1,s.value=0,clearTimeout(t))},1e3)}}}const x={setup(){R();const e=l(""),s=l(""),{onSubmit:a}=V();return{getImgUrl:N,phoneRef:e,codeRef:s,onSubmit:a,...j(e)}}},A=e=>(L("data-v-c3593bd1"),e=e(),y(),e),q={class:"flex-column root"},w=["src"],G={class:"field-wrap"},H={class:"flex"},K=A(()=>o("span",null,"+86",-1)),X=["src"],k={class:"field-wrap"},B={style:{"margin-top":"40px"}},J=A(()=>o("p",{class:"note"},[C(" \u767B\u5F55\u5373\u4EE3\u8868\u60A8\u540C\u610F "),o("span",{class:"red-char"},"\u300A\u7528\u6237\u4F7F\u7528\u534F\u8BAE\u300B"),C("\u548C "),o("span",{class:"red-char"},"\u300A\u9690\u79C1\u534F\u8BAE\u300B")],-1)),z={class:"circle-box"},Q=["src"],Y=["src"],$=["src"];function Z(e,s,a,r,d,t){const p=c("van-field"),n=c("van-button"),i=c("van-form");return U(),h("div",q,[o("img",{class:"img_happy",src:r.getImgUrl("login_img_happy.png"),alt:""},null,8,w),_(i,{class:"form-wrap",onSubmit:r.onSubmit},{default:g(()=>[o("div",G,[o("div",H,[K,o("img",{class:"arr-icon",src:r.getImgUrl("login_filed_arr.png"),alt:""},null,8,X)]),_(p,{class:"phoneRef-field",modelValue:r.phoneRef,"onUpdate:modelValue":s[0]||(s[0]=m=>r.phoneRef=m),name:"phone",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),o("div",k,[_(p,{class:"phoneRef-field",modelValue:r.codeRef,"onUpdate:modelValue":s[1]||(s[1]=m=>r.codeRef=m),name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),E(o("span",{class:"send-code",onClick:s[2]||(s[2]=(...m)=>e.handleSendCode&&e.handleSendCode(...m))},"\u83B7\u53D6\u9A8C\u8BC1\u7801",512),[[u,!e.isSend]]),E(o("span",{class:"send-code grey"},"\u5DF2\u53D1\u9001\uFF08"+f(e.sendTime)+"s\uFF09",513),[[u,e.isSend]])]),o("div",B,[_(n,{round:"",block:"",class:"btn-submit",type:"primary","native-type":"submit"},{default:g(()=>[C(" \u4E0B\u4E00\u6B65 ")]),_:1})])]),_:1},8,["onSubmit"]),J,o("div",z,[o("img",{class:"cic-img",src:r.getImgUrl("login_img_circle.png"),alt:""},null,8,Q),o("img",{class:"char-img",src:r.getImgUrl("login_bottom_char.png"),alt:""},null,8,Y),o("img",{class:"c-bottom",src:r.getImgUrl("login_img_circle.png"),alt:""},null,8,$)])])}const ne=v(x,[["render",Z],["__scopeId","data-v-c3593bd1"]]);export{ne as default};
