import{g as N}from"./ak.3c5b7ffd.js";import{r as O,u,l as F,b as C,g as M,d as T,T as D,f as l,_ as U,h as c,o as v,c as h,a as o,i as _,w as g,j as E,v as R,t as f,k as S,p as L,m as y}from"./index.6cadc58e.js";const W=async e=>await O("https://api.lc.familyeducation.org.cn/v1/user/auth/phone",e),b=async e=>await O("https://api.lc.familyeducation.org.cn/v1/user/auth/send",e);function V(){const e=u(),s=async(n,i)=>await W({phone:n,code:i}),a=async()=>await M(),r=async n=>await T({url:n}),P=n=>{const i=/^[1][3-9][\d]{9}/;return n?i.test(n)||D("\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E"):D("\u8BF7\u8F93\u5165\u624B\u673A\u53F7"),i.test(n)},m=F();return{onSubmit:async n=>{if(console.log("submit",n),!P(n.phone))return;const i=await s(n.phone,n.code);m.getLoginInfo(i.token,i.uid).then(async t=>{const p=await a();p.wx_id&&C().setWxId(p.wx_id),C().userInfo.wx_id?(console.log(e),e.push({path:"/basicInformation"})):r("https://lc.familyeducation.org.cn/#/basicInformation").then(I=>{window.location.href=I})})}}}function j(e){const s=l(60),a=l(!1),r=async()=>{const m={phone:e.value};console.log(m),await b(m)};return{sendTime:s,isSend:a,handleSendCode:async()=>{await r(),a.value=!0;const m=setInterval(()=>{s.value--,s.value<=0&&(a.value=!1,s.value=0,clearTimeout(m))},1e3)}}}const x={setup(){u();const e=l(""),s=l(""),{onSubmit:a}=V();return{getImgUrl:N,phoneRef:e,codeRef:s,onSubmit:a,...j(e)}}},A=e=>(L("data-v-c3593bd1"),e=e(),y(),e),q={class:"flex-column root"},w=["src"],G={class:"field-wrap"},H={class:"flex"},K=A(()=>o("span",null,"+86",-1)),B=["src"],X={class:"field-wrap"},k={style:{"margin-top":"40px"}},J=A(()=>o("p",{class:"note"},[S(" \u767B\u5F55\u5373\u4EE3\u8868\u60A8\u540C\u610F "),o("span",{class:"red-char"},"\u300A\u7528\u6237\u4F7F\u7528\u534F\u8BAE\u300B"),S("\u548C "),o("span",{class:"red-char"},"\u300A\u9690\u79C1\u534F\u8BAE\u300B")],-1)),z={class:"circle-box"},Y=["src"],$=["src"],Q=["src"];function Z(e,s,a,r,P,m){const d=c("van-field"),n=c("van-button"),i=c("van-form");return v(),h("div",q,[o("img",{class:"img_happy",src:r.getImgUrl("login_img_happy.png"),alt:""},null,8,w),_(i,{class:"form-wrap",onSubmit:r.onSubmit},{default:g(()=>[o("div",G,[o("div",H,[K,o("img",{class:"arr-icon",src:r.getImgUrl("login_filed_arr.png"),alt:""},null,8,B)]),_(d,{class:"phoneRef-field",modelValue:r.phoneRef,"onUpdate:modelValue":s[0]||(s[0]=t=>r.phoneRef=t),name:"phone",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),o("div",X,[_(d,{class:"phoneRef-field",modelValue:r.codeRef,"onUpdate:modelValue":s[1]||(s[1]=t=>r.codeRef=t),name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),E(o("span",{class:"send-code",onClick:s[2]||(s[2]=(...t)=>e.handleSendCode&&e.handleSendCode(...t))},"\u83B7\u53D6\u9A8C\u8BC1\u7801",512),[[R,!e.isSend]]),E(o("span",{class:"send-code grey"},"\u5DF2\u53D1\u9001\uFF08"+f(e.sendTime)+"s\uFF09",513),[[R,e.isSend]])]),o("div",k,[_(n,{round:"",block:"",class:"btn-submit",type:"primary","native-type":"submit"},{default:g(()=>[S(" \u4E0B\u4E00\u6B65 ")]),_:1})])]),_:1},8,["onSubmit"]),J,o("div",z,[o("img",{class:"cic-img",src:r.getImgUrl("login_img_circle.png"),alt:""},null,8,Y),o("img",{class:"char-img",src:r.getImgUrl("login_bottom_char.png"),alt:""},null,8,$),o("img",{class:"c-bottom",src:r.getImgUrl("login_img_circle.png"),alt:""},null,8,Q)])])}const ne=U(x,[["render",Z],["__scopeId","data-v-c3593bd1"]]);export{ne as default};
