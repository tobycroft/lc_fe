import{g as F}from"./ak.42431a64.js";import{r as O,u as A,l as T,b as S,g as I,d as U,T as D,f as P,_ as h,h as c,o as v,c as f,a as s,i as d,w as g,D as E,j as u,v as R,t as y,k as C,p as L,m as W}from"./index.59f7089f.js";const b=async e=>await O("https://api.lc.familyeducation.org.cn/v1/user/auth/phone",e),x=async e=>await O("https://api.lc.familyeducation.org.cn/v1/user/auth/send",e);function j(){const e=A(),o=async(r,a)=>await b({phone:r,code:a}),t=async()=>await I(),n=async r=>await U({url:r}),_=r=>{const a=/^[1][3-9][\d]{9}/;return r?a.test(r)||D("\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E"):D("\u8BF7\u8F93\u5165\u624B\u673A\u53F7"),a.test(r)},i=T();return{onSubmit:async r=>{if(console.log("submit",r),!_(r.phone))return;const a=await o(r.phone,r.code);i.getLoginInfo(a.token,a.uid).then(async m=>{const p=await t();p.wx_id&&S().setWxId(p.wx_id),S().userInfo.wx_id?e.push({path:"/basicInformation"}):n("https://lc.familyeducation.org.cn/#/login").then(N=>{window.location.href=N})})}}}function V(e){const o=P(60),t=P(!1),n=async()=>{const i={phone:e.value};console.log(i),await x(i)};return{sendTime:o,isSend:t,handleSendCode:async()=>{await n(),t.value=!0;const i=setInterval(()=>{o.value--,o.value<=0&&(t.value=!1,o.value=0,clearTimeout(i))},1e3)}}}const q={setup(){const e=A(),o=P(""),t=P("");(()=>{const i=e.currentRoute.value.query;i.code==500?E.alert({message:i.echo}):i.code==0&&E.alert({message:i.echo}).then(async()=>{const l=await I();S().setWxId(l.wx_id),e.push({path:"/basicInformation"})})})();const{onSubmit:_}=j();return{getImgUrl:F,phoneRef:o,codeRef:t,onSubmit:_,...V(o)}}},M=e=>(L("data-v-9d002806"),e=e(),W(),e),w={class:"flex-column root"},G=["src"],H={class:"field-wrap"},K={class:"flex"},B=M(()=>s("span",null,"+86",-1)),k=["src"],X={class:"field-wrap"},J={style:{"margin-top":"40px"}},z=M(()=>s("p",{class:"note"},[C(" \u767B\u5F55\u5373\u4EE3\u8868\u60A8\u540C\u610F "),s("span",{class:"red-char"},"\u300A\u7528\u6237\u4F7F\u7528\u534F\u8BAE\u300B"),C("\u548C "),s("span",{class:"red-char"},"\u300A\u9690\u79C1\u534F\u8BAE\u300B")],-1)),Z={class:"circle-box"},$=["src"],Q=["src"],Y=["src"];function ee(e,o,t,n,_,i){const l=c("van-field"),r=c("van-button"),a=c("van-form");return v(),f("div",w,[s("img",{class:"img_happy",src:n.getImgUrl("login_img_happy.png"),alt:""},null,8,G),d(a,{class:"form-wrap",onSubmit:n.onSubmit},{default:g(()=>[s("div",H,[s("div",K,[B,s("img",{class:"arr-icon",src:n.getImgUrl("login_filed_arr.png"),alt:""},null,8,k)]),d(l,{class:"phoneRef-field",modelValue:n.phoneRef,"onUpdate:modelValue":o[0]||(o[0]=m=>n.phoneRef=m),name:"phone",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),s("div",X,[d(l,{class:"phoneRef-field",modelValue:n.codeRef,"onUpdate:modelValue":o[1]||(o[1]=m=>n.codeRef=m),name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),u(s("span",{class:"send-code",onClick:o[2]||(o[2]=(...m)=>e.handleSendCode&&e.handleSendCode(...m))},"\u83B7\u53D6\u9A8C\u8BC1\u7801",512),[[R,!e.isSend]]),u(s("span",{class:"send-code grey"},"\u5DF2\u53D1\u9001\uFF08"+y(e.sendTime)+"s\uFF09",513),[[R,e.isSend]])]),s("div",J,[d(r,{round:"",block:"",class:"btn-submit",type:"primary","native-type":"submit"},{default:g(()=>[C(" \u4E0B\u4E00\u6B65 ")]),_:1})])]),_:1},8,["onSubmit"]),z,s("div",Z,[s("img",{class:"cic-img",src:n.getImgUrl("login_img_circle.png"),alt:""},null,8,$),s("img",{class:"char-img",src:n.getImgUrl("login_bottom_char.png"),alt:""},null,8,Q),s("img",{class:"c-bottom",src:n.getImgUrl("login_img_circle.png"),alt:""},null,8,Y)])])}const re=h(q,[["render",ee],["__scopeId","data-v-9d002806"]]);export{re as default};
