import{g as N}from"./ak.1933dec5.js";import{j as u,u as A,l as M,e as D,g as F,f as T,T as g,r as _,_ as U,a as c,o as v,c as h,b as o,d as l,k as E,w as O,v as R,t as f,m as S,p as L,i as y}from"./index.6e6e1e56.js";const W=async e=>await u("https://api.lc.familyeducation.org.cn/v1/user/auth/phone",e),b=async e=>await u("https://api.lc.familyeducation.org.cn/v1/user/auth/send",e);function V(){const e=A(),n=async(r,i)=>await W({phone:r,code:i}),a=async()=>await F(),s=async r=>await T({url:r}),d=r=>{const i=/^[1][3-9][\d]{9}/;return r?i.test(r)||g("\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E"):g("\u8BF7\u8F93\u5165\u624B\u673A\u53F7"),i.test(r)},m=M();return{onSubmit:async r=>{if(console.log("submit",r),!d(r.phone))return;const i=await n(r.phone,r.code);m.getLoginInfo(i.token,i.uid).then(async t=>{const p=await a();p.wx_id&&D().setWxId(p.wx_id),D().userInfo.wx_id?(console.log(e),e.push({path:"/basicInformation"})):s("https://lc.familyeducation.org.cn/#/basicInformation").then(I=>{window.location.href=I})})}}}function j(e){const n=_(60),a=_(!1),s=async()=>{const m={phone:e.value};console.log(m),await b(m)};return{sendTime:n,isSend:a,handleSendCode:async()=>{await s(),a.value=!0;const m=setInterval(()=>{n.value--,n.value<=0&&(a.value=!1,n.value=0,clearTimeout(m))},1e3)}}}const x={setup(){A();const e=_(""),n=_(""),a=_(!1),{onSubmit:s}=V();return{checkVal:a,getImgUrl:N,phoneRef:e,codeRef:n,onSubmit:s,...j(e)}}},C=e=>(L("data-v-3c0db908"),e=e(),y(),e),q={class:"flex-column root"},w=C(()=>o("div",{class:"title"},"\u664B\u6C5F\u5E02\u65B0\u664B\u5BB6\u5EAD\u80FD\u529B\u4FC3\u8FDB\u5E73\u53F0",-1)),G=["src"],K={class:"field-wrap"},H={class:"flex"},B=C(()=>o("span",null,"+86",-1)),k=["src"],X={class:"field-wrap"},J={style:{"margin-top":"40px"}},z=C(()=>o("p",{class:"note"},[S(" \u767B\u5F55\u5373\u4EE3\u8868\u60A8\u540C\u610F "),o("span",{class:"red-char"},"\u300A\u7528\u6237\u4F7F\u7528\u534F\u8BAE\u300B"),S("\u548C "),o("span",{class:"red-char"},"\u300A\u9690\u79C1\u534F\u8BAE\u300B")],-1)),$={class:"circle-box"},Y=["src"],Q=["src"],Z=["src"];function ee(e,n,a,s,d,m){const P=c("van-field"),r=c("van-button"),i=c("van-form");return v(),h("div",q,[o("header",null,[w,o("img",{class:"img_happy",src:s.getImgUrl("login_img_happy.png"),alt:""},null,8,G)]),l(i,{class:"form-wrap",onSubmit:s.onSubmit},{default:E(()=>[o("div",K,[o("div",H,[B,o("img",{class:"arr-icon",src:s.getImgUrl("login_filed_arr.png"),alt:""},null,8,k)]),l(P,{class:"phoneRef-field",modelValue:s.phoneRef,"onUpdate:modelValue":n[0]||(n[0]=t=>s.phoneRef=t),name:"phone",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),o("div",X,[l(P,{class:"phoneRef-field",modelValue:s.codeRef,"onUpdate:modelValue":n[1]||(n[1]=t=>s.codeRef=t),name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),O(o("span",{class:"send-code",onClick:n[2]||(n[2]=(...t)=>e.handleSendCode&&e.handleSendCode(...t))},"\u83B7\u53D6\u9A8C\u8BC1\u7801",512),[[R,!e.isSend]]),O(o("span",{class:"send-code grey"},"\u5DF2\u53D1\u9001\uFF08"+f(e.sendTime)+"s\uFF09",513),[[R,e.isSend]])]),o("div",J,[l(r,{round:"",block:"",class:"btn-submit",type:"primary","native-type":"submit"},{default:E(()=>[S(" \u4E0B\u4E00\u6B65 ")]),_:1})])]),_:1},8,["onSubmit"]),z,o("div",$,[o("img",{class:"cic-img",src:s.getImgUrl("login_img_circle.png"),alt:""},null,8,Y),o("img",{class:"char-img",src:s.getImgUrl("login_bottom_char.png"),alt:""},null,8,Q),o("img",{class:"c-bottom",src:s.getImgUrl("login_img_circle.png"),alt:""},null,8,Z)])])}const re=U(x,[["render",ee],["__scopeId","data-v-3c0db908"]]);export{re as default};
