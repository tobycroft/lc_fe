import{g as N}from"./ak.f9236663.js";import{e as R,u as A,l as T,f as C,g as F,h,T as D,i as d,_ as U,r as P,o as v,c as f,j as s,a as l,w as g,D as E,k as u,v as O,t as y,d as S,p as L,m as W}from"./index.d2f02413.js";const V=async e=>await R("https://api.lc.familyeducation.org.cn/v1/user/auth/phone",e),b=async e=>await R("https://api.lc.familyeducation.org.cn/v1/user/auth/send",e);function j(){const e=A(),o=async(r,a)=>await V({phone:r,code:a}),t=async()=>await F(),n=async r=>await h({url:r}),_=r=>{const a=/^[1][3-9][\d]{9}/;return r?a.test(r)||D("\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E"):D("\u8BF7\u8F93\u5165\u624B\u673A\u53F7"),a.test(r)},i=T();return{onSubmit:async r=>{if(console.log("submit",r),!_(r.phone))return;const a=await o(r.phone,r.code);i.getLoginInfo(a.token,a.uid).then(async m=>{const c=await t();c.wx_id&&C().setWxId(c.wx_id),C().userInfo.wx_id?e.push({path:"/basicInformation"}):n("https://lc.familyeducation.org.cn/#/basicInformation").then(M=>{window.location.href=M})})}}}function x(e){const o=d(60),t=d(!1),n=async()=>{const i={phone:e.value};console.log(i),await b(i)};return{sendTime:o,isSend:t,handleSendCode:async()=>{await n(),t.value=!0;const i=setInterval(()=>{o.value--,o.value<=0&&(t.value=!1,o.value=0,clearTimeout(i))},1e3)}}}const q={setup(){const e=A(),o=d(""),t=d("");(()=>{console.log("route",e.currentRoute.value.query);const i=e.currentRoute.value.query;i.code==500?E.alert({message:i.echo}).then(()=>{e.push({path:"/basicInformation"})}):i.code==0&&E.alert({message:i.echo})})();const{onSubmit:_}=j();return{getImgUrl:N,phoneRef:o,codeRef:t,onSubmit:_,...x(o)}}},I=e=>(L("data-v-730f4508"),e=e(),W(),e),w={class:"flex-column root"},G=["src"],H={class:"field-wrap"},K={class:"flex"},X=I(()=>s("span",null,"+86",-1)),k=["src"],B={class:"field-wrap"},J={style:{"margin-top":"40px"}},z=I(()=>s("p",{class:"note"},[S(" \u767B\u5F55\u5373\u4EE3\u8868\u60A8\u540C\u610F "),s("span",{class:"red-char"},"\u300A\u7528\u6237\u4F7F\u7528\u534F\u8BAE\u300B"),S("\u548C "),s("span",{class:"red-char"},"\u300A\u9690\u79C1\u534F\u8BAE\u300B")],-1)),Y={class:"circle-box"},$=["src"],Q=["src"],Z=["src"];function ee(e,o,t,n,_,i){const p=P("van-field"),r=P("van-button"),a=P("van-form");return v(),f("div",w,[s("img",{class:"img_happy",src:n.getImgUrl("login_img_happy.png"),alt:""},null,8,G),l(a,{class:"form-wrap",onSubmit:n.onSubmit},{default:g(()=>[s("div",H,[s("div",K,[X,s("img",{class:"arr-icon",src:n.getImgUrl("login_filed_arr.png"),alt:""},null,8,k)]),l(p,{class:"phoneRef-field",modelValue:n.phoneRef,"onUpdate:modelValue":o[0]||(o[0]=m=>n.phoneRef=m),name:"phone",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),s("div",B,[l(p,{class:"phoneRef-field",modelValue:n.codeRef,"onUpdate:modelValue":o[1]||(o[1]=m=>n.codeRef=m),name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),u(s("span",{class:"send-code",onClick:o[2]||(o[2]=(...m)=>e.handleSendCode&&e.handleSendCode(...m))},"\u83B7\u53D6\u9A8C\u8BC1\u7801",512),[[O,!e.isSend]]),u(s("span",{class:"send-code grey"},"\u5DF2\u53D1\u9001\uFF08"+y(e.sendTime)+"s\uFF09",513),[[O,e.isSend]])]),s("div",J,[l(r,{round:"",block:"",class:"btn-submit",type:"primary","native-type":"submit"},{default:g(()=>[S(" \u4E0B\u4E00\u6B65 ")]),_:1})])]),_:1},8,["onSubmit"]),z,s("div",Y,[s("img",{class:"cic-img",src:n.getImgUrl("login_img_circle.png"),alt:""},null,8,$),s("img",{class:"char-img",src:n.getImgUrl("login_bottom_char.png"),alt:""},null,8,Q),s("img",{class:"c-bottom",src:n.getImgUrl("login_img_circle.png"),alt:""},null,8,Z)])])}const re=U(q,[["render",ee],["__scopeId","data-v-730f4508"]]);export{re as default};
